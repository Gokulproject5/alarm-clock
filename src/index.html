<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>alarm</title>
    <link href="src/index.css" rel="stylesheet" />
    <link rel="shortcut icon" href="./cdnlogo.png" type="image/x-icon" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Zalando+Sans+SemiExpanded:ital,wght@0,200..900;1,200..900&display=swap"
      rel="stylesheet"
    />
  </head>

  <body
    class="bg-black min-h-screen flex items-center justify-center font-poppins"
  >
    <main>
      <div class="relative z-10">
        <!-- overlay -->
        <div id="alertDiv"></div>
        <div
          class="absolute pointer-events-none inset-0 bg-gradient-to-r from-[#00F5FF] via-[#4FACFE] to-[#9B5CFF] blur-2xl opacity-30 bg-[length:300%_300%] animate-[pulse_3s_linear_infinite] "
        ></div>
        <!-- content -->
        <div
          class="realtive z-10 w-[280px] md:w-[400px] lg:w-[500px] flex flex-col items-center bg-gray-500 shadow-[1px_1px_3px] shadow-white font-semibold mx-auto px-4 pt-5 rounded-xl"
        >
          <h1
            class="text-4xl lg:text-5xl mb-5 bg-linear-to-r from-[#00F5FF] via-[#4FACFE] to-[#9B5CFF] bg-clip-text text-transparent"
          >
            Alarm Clock
          </h1>
          <div class="mb-2 flex flex-col space-y-5 w-full max-w-md">
            <p
              class="px-2 text-center text-4xl bg-black text-white rounded"
              id="time"
            >
              00:00:00
            </p>
            <!-- audio -->
            <div>
              <audio
                id="alarm-audio"
                src="/src/assets/preview.mp3"
                preload="auto"
              ></audio>
            </div>
            <!-- set alarm -->
            <label for="" class="text-black mb-1 text-lg">Set Alarm:</label>
            <div
              class="flex gap-2 text-gray-600 bg-gray-300 px-2 py-1 rounded-md shadow-[1px_1px_3px] shadow-gray-600"
            >
              <input
                type="input"
                min="1"
                max="12"
                placeholder="HH"
                class="outline-0 px-2 w-20 text-center flex-2"
                id="Hourinputvalue"
              />

              <input
                type="input"
                min="0"
                max="59"
                placeholder="MM"
                class="outline-0 px-2 w-20 text-center flex-2"
                id="minuteinputvalue"
              />

              <select class="outline-0 p-2 flex-1">
                <option class="ampm">AM</option>
                <option class="ampm">PM</option>
              </select>
            </div>

            <!-- Buttons -->
            <div class="flex justify-center space-x-4 py-3">
              <button
                class="rounded cursor-pointer p-2 hover:bg-linear-to-br from-[#00F5FF] via-[#4FACFE] to-[#9B5CFF] text-black"
                id="Setbtn"
              >
                Set Alarm
              </button>
              <button
                class="rounded cursor-pointer p-2 hover:bg-linear-to-br from-[#00F5FF] via-[#4FACFE] to-[#9B5CFF] text-black"
                id="cancelbtn"
              >
                Cancel Alarm
              </button>
              <button
                class="rounded cursor-pointer p-2 hover:bg-linear-to-br from-[#00F5FF] via-[#4FACFE] to-[#9B5CFF] text-black"
                id="snoozebtn"
              >
                snooze
              </button>
            </div>
          </div>
        </div>
      </div>
    </main>
    <script>
        const timeDisplay = document.getElementById("time");
const hourInput = document.getElementById("Hourinputvalue");
const minuteInput = document.getElementById("minuteinputvalue");
const ampmSelect = document.querySelector("select");
const setBtn = document.getElementById("Setbtn");
const cancelBtn = document.getElementById("cancelbtn");
const snoozeBtn = document.getElementById("snoozebtn");
const alarmAudio = document.getElementById("alarm-audio");
const alertDiv = document.getElementById("alertDiv");

let alarmtime = "";
let isRinging = false;
const snoozeMinutes = 1;

// display the current time
function displaytime() {
  const now = new Date();
  let hours = now.getHours();
  const minutes = now.getMinutes().toString().padStart(2, "0");
  const seconds = now.getSeconds().toString().padStart(2, "0");
  const ampm = hours >= 12 ? "PM" : "AM";

  hours = (hours % 12 || 12).toString().padStart(2, "0");

  timeDisplay.textContent = `${hours}:${minutes}:${seconds} ${ampm}`;

  if (alarmtime === `${hours}:${minutes}${ampm}` && !isRinging) {
    isRinging = true;
    ringAlarm();
  }
}

setInterval(displaytime, 1000);
displaytime();

// set Alarm
setBtn.addEventListener("click", () => {
  const hRaw = hourInput.value.trim();
  const mRaw = minuteInput.value.trim();
  const ap = ampmSelect.value;

  // Empty check
  if (hRaw === "" || mRaw === "") {
    alertfunc("Enter valid time");
    return;
  }

  const hNum = Number(hRaw);
  const mNum = Number(mRaw);

  // Number + range check
  if (
    Number.isNaN(hNum) || Number.isNaN(mNum) ||
    hNum < 1 || hNum > 12 ||
    mNum < 0 || mNum > 59
  ) {
    alertfunc("Enter valid time");
    return;
  }

  const h = hNum.toString().padStart(2, "0");
  const m = mNum.toString().padStart(2, "0");

  alarmtime = `${h}:${m}${ap}`;
  alertfunc(`Alarm set ${alarmtime}`);
});


// /Alarm setting
function ringAlarm() {
  alarmAudio.loop = true;
  alarmAudio.currentTime = 0;
  alarmAudio.play().catch((err) => console.log(err));
}

// Snooze Alarm
snoozeBtn.addEventListener("click", () => {
  if (!isRinging) return;

  alarmAudio.pause();
  alarmAudio.currentTime = 0;

  let now = new Date();
  now.setMinutes(now.getMinutes() + snoozeMinutes);

  let hours = now.getHours();
  let minutes = now.getMinutes().toString().padStart(2, "0");
  let ampm = hours >= 12 ? "PM" : "AM";

  hours = (hours % 12 || 12).toString().padStart(2, "0");

  alarmtime = `${hours}:${minutes}${ampm}`;
  alertfunc(`alarm Snooze in ${alarmtime}`);
  isRinging = false;
});

// Cancel alarm
cancelBtn.addEventListener("click", () => {
  alarmAudio.pause();
  alarmAudio.currentTime = 0;
  alarmAudio.loop = false;

  alarmtime = "";
  isRinging = false;

  alertfunc("Alarm Cancel");
});

// alert Func
function alertfunc(message) {
  alertDiv.innerHTML = "";
  let alertContainer = document.createElement("div");
  alertContainer.className =
    " bg-gradient-to-r from-[#00F5FF] via-[#4FACFE] to-[#9B5CFF] backdrop-blur-xl opacity-100 bg-[length:300%_300%] animate-[pulse_3s_linear_infinite] text-black rounded-sm font-medium text-center text-lg fixed top-0 w-120 shadow-md shadow-gray-600 px-2 py-2  transition-all duration-300 ease-in-out translate-y-30";
  let alertText = document.createElement("p");
  alertText.innerText = message;

  alertContainer.append(alertText);
  alertDiv.append(alertContainer);

  // setTimeout
  setTimeout(() => {
    alertContainer.remove();
  }, 3000);
}
    </script>
  </body>
</html>